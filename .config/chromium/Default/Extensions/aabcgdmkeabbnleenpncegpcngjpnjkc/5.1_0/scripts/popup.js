/*Copyright (c) 2019 ksoft http://www.dummysoftware.com*/function onInitialize(){var e=document.querySelector("#interval");chrome.tabs.query({active:!0,currentWindow:!0},function(t){var n=t[0],o=getOptions(n);if(null!=o&&e){var i=o.interval,c=document.querySelector("#chkRandom");1==o.isRandom?(i=o.random+"?",c.checked=!0):c.checked=!1,e.value=i,e.select();var r=document.querySelector("#status");1==o.refresh?r.innerHTML="ON":r.innerHTML="OFF",1==o.isDomain&&(document.querySelector("#chkDomain").checked=!0),1==o.isCache&&(document.querySelector("#chkCache").checked=!0),1==o.isTimer&&(document.querySelector("#chkTimer").checked=!0),1==o.isAllTabs&&(document.querySelector("#chkAllTabs").checked=!0);var u=document.querySelector("#lblLastRefresh"),a=document.querySelector("#lblNextRefresh");isRegistered()&&null!=o.lastRefresh?(u.innerHTML=o.lastRefresh,a.innerHTML=o.nextRefresh):(u.innerHTML="n/a",a.innerHTML="n/a"),1==o.isAutoClick&&(document.querySelector("#chkAutoClick").checked=!0,document.querySelector("#autoClickDiv").style.maxHeight="60px",document.querySelector("#autoClickDiv").classList.add("visible")),document.querySelector("#txtAutoClickId").value=o.autoClickId,document.querySelector("#txtAutoClickIdStatus").setAttribute("data-valid",o.autoClickIdValid),1==o.isAutoClickAfterRefresh&&(document.querySelector("#chkClickAfterRefresh").checked=!0),1==o.isNotify&&(document.querySelector("#chkNotify").checked=!0,document.querySelector("#notifyDiv").style.maxHeight="40px",document.querySelector("#notifyDiv").classList.add("visible")),document.querySelector("#txtNotifyText").value=o.notifyText,1==o.isUrlList&&(document.querySelector("#chkUrlList").checked=!0,document.querySelector("#urlListDiv").style.maxHeight="125px",document.querySelector("#urlListDiv").classList.add("visible")),document.querySelector("#txtUrlList").value=o.urlList?o.urlList.join("\n"):"",1==o.isTimeList&&(document.querySelector("#chkTimeList").checked=!0,document.querySelector("#timeListDiv").style.maxHeight="100px",document.querySelector("#timeListDiv").classList.add("visible")),document.querySelector("#txtTimeList").value=o.timeList?o.timeList.join("\n"):"",isRegistered()&&chrome.runtime.onMessage.addListener(function(t,o,i){t.tabId==n.id&&("updateLastRefresh"==t.message?(u.innerHTML=t.lastRefresh,a.innerHTML=t.nextRefresh):"updateRandomInterval"==t.message?e.value=t.value+"?":"updateTimeInterval"==t.message&&(e.value=t.value))})}var d=document.querySelector("#lblDomain");d&&(d.innerHTML=getDomain(n.url))}),e&&(e.removeEventListener("keydown",AYIrO),e.addEventListener("keydown",AYIrO),HMUyC())}function AYIrO(e){46==e.keyCode||8==e.keyCode||9==e.keyCode||e.keyCode>=35&&e.keyCode<=40||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}function HMUyC(){document.querySelector("#interval").select();var e=document.querySelector("#imgLock");e.removeEventListener("click",onLockClick),e.addEventListener("click",onLockClick);var t=(dataSync(),document.querySelector("#advancedOptionsDiv"));t.removeEventListener("click",ABTgj),t.addEventListener("click",ABTgj);var n=document.querySelector("#txtCode");n&&(n.removeEventListener("keypress",WauWp),n.addEventListener("keypress",WauWp));var o=document.querySelector("#btnStart");o.removeEventListener("click",cWtgI),o.addEventListener("click",cWtgI);var i=document.querySelector("#btnStop");i.removeEventListener("click",ajjyB),i.addEventListener("click",ajjyB);var c=document.querySelector("#chkDomain");c.removeEventListener("click",GPmdV),c.addEventListener("click",GPmdV);var r=document.querySelector("#chkRandom");r.removeEventListener("click",bqHRq),r.addEventListener("click",bqHRq);var u=document.querySelector("#chkCache");u.removeEventListener("click",gClaw),u.addEventListener("click",gClaw);var a=document.querySelector("#chkTimer");a.removeEventListener("click",gClaw),a.addEventListener("click",gClaw);var d=document.querySelector("#chkAllTabs");d.removeEventListener("click",gClaw),d.addEventListener("click",gClaw);var l=document.querySelector("#btnRegister");l&&(l.removeEventListener("click",validateRegistrationCode),l.addEventListener("click",validateRegistrationCode));var s=document.querySelector("#chkAutoClick");s.removeEventListener("click",sBgFu),s.addEventListener("click",sBgFu);var v=document.querySelector("#txtAutoClickId");v.removeEventListener("keyup",rteIh),v.addEventListener("keyup",rteIh),v.removeEventListener("paste",rteIh),v.addEventListener("paste",rteIh);var m=document.querySelector("#chkClickAfterRefresh");m.removeEventListener("click",gClaw),m.addEventListener("click",gClaw);var k=document.querySelector("#chkNotify");k.removeEventListener("click",etYZs),k.addEventListener("click",etYZs);var y=document.querySelector("#txtNotifyText");y.removeEventListener("keyup",gClaw),y.addEventListener("keyup",gClaw),y.removeEventListener("paste",gClaw),y.addEventListener("paste",gClaw);var p=document.querySelector("#chkUrlList");p.removeEventListener("click",QEQMV),p.addEventListener("click",QEQMV);var h=document.querySelector("#txtUrlList");h.removeEventListener("keyup",gClaw),h.addEventListener("keyup",gClaw),h.removeEventListener("paste",gClaw),h.addEventListener("paste",gClaw);var L=document.querySelector("#chkTimeList");L.removeEventListener("click",onChkTimeList),L.addEventListener("click",onChkTimeList);var S=document.querySelector("#txtTimeList");S.removeEventListener("keyup",gClaw),S.addEventListener("keyup",gClaw),S.removeEventListener("paste",gClaw),S.addEventListener("paste",gClaw)}function ABTgj(){var e=document.querySelector("#advancedOptions"),t=document.querySelector("#imgAdvancedOptions");e.style.maxHeight&&"0px"!=e.style.maxHeight?t.style.backgroundPosition="0px 0px":(t.style.backgroundPosition="-15px 0px",UQfjQ()),slide(e,advancedOptionsSlideHeight)}function WauWp(e){13==e.keyCode&&document.querySelector("#btnRegister").click()}function sBgFu(){slide(document.querySelector("#autoClickDiv"),"60px"),document.querySelector("#txtAutoClickId").focus(),rteIh()}function etYZs(){slide(document.querySelector("#notifyDiv"),"40px"),document.querySelector("#txtNotifyText").focus(),gClaw()}function QEQMV(){slide(document.querySelector("#urlListDiv"),"125px"),document.querySelector("#txtUrlList").focus(),gClaw()}function onChkTimeList(){slide(document.querySelector("#timeListDiv"),"100px"),document.querySelector("#txtTimeList").focus(),gClaw()}function cWtgI(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=getOptions(t);n.interval=document.querySelector("#interval").value,n.refresh=!0,n=MEjeu(n),updateOptions(t,n),chrome.extension.sendRequest({tab:t,refresh:n.refresh},function(e){}),window.close()})}function ajjyB(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n={};n.interval=document.querySelector("#interval").value,n.refresh=!1,n=MEjeu(n),updateOptions(t,n),chrome.extension.sendRequest({tab:t,refresh:n.refresh},function(e){}),window.close()})}function bqHRq(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=document.querySelector("#interval");0==document.querySelector("#chkRandom").checked?n.value=n.value.replace(/\?/g,""):n.value=n.value+"?";var o=getOptions(t);o.interval=n.value,o=MEjeu(o),updateOptions(t,o)})}function GPmdV(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];if(document.querySelector("#chkDomain").checked){var n=getOptions(t);n.interval=document.querySelector("#interval").value,n=MEjeu(n),localStorage[getDomain(t.url)]=n,updateOptions(t,n)}else localStorage.removeItem(getDomain(t.url))})}function gClaw(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],n=getOptions(t);n.interval=document.querySelector("#interval").value,n=MEjeu(n),updateOptions(t,n)})}function rteIh(){UQfjQ(function(){gClaw()})}function UQfjQ(e){var t=document.querySelector("#txtAutoClickIdStatus"),n=document.querySelector("#txtAutoClickId").value;null!=n&&n.length>0?chrome.tabs.query({active:!0,currentWindow:!0},function(o){var i=o[0];chrome.tabs.executeScript(i.id,{file:"scripts/content.js"},function(o){chrome.tabs.sendMessage(i.id,{action:"getAutoClickIdStatus"+n},function(n){void 0!==n&&"OK"==n.result?(t.innerHTML="<img src='/images/green-check.png' alt='OK' title='OK'>",t.setAttribute("data-valid","1")):(t.innerHTML="<img src='/images/red-x.png' alt='Invalid selector or control not found in page' title='Control not found in page'>",t.setAttribute("data-valid","0")),e&&e()})})}):(t.innerHTML="",t.setAttribute("data-valid","0"),e&&e())}function MEjeu(e){return e.isRandom=document.querySelector("#chkRandom").checked,e.random=e.interval,e.isDomain=document.querySelector("#chkDomain").checked,e.isCache=document.querySelector("#chkCache").checked,e.isTimer=document.querySelector("#chkTimer").checked,e.isAllTabs=document.querySelector("#chkAllTabs").checked,e.isAutoClick=document.querySelector("#chkAutoClick").checked,e.autoClickId=document.querySelector("#txtAutoClickId").value,e.autoClickIdValid=document.querySelector("#txtAutoClickIdStatus").getAttribute("data-valid"),e.isAutoClickAfterRefresh=document.querySelector("#chkClickAfterRefresh").checked,e.isNotify=document.querySelector("#chkNotify").checked,e.notifyText=document.querySelector("#txtNotifyText").value,e.isUrlList=document.querySelector("#chkUrlList").checked,e.urlList=cleanUrlArray(document.querySelector("#txtUrlList").value.match(/.+/g)),e.isTimeList=document.querySelector("#chkTimeList").checked,e.timeList=cleanTimeArray(document.querySelector("#txtTimeList").value.match(/.+/g)),e}function updateOptions(e,t){return t.interval=t.interval.replace(/\?/g,""),t.random=t.random.replace(/\?/g,""),saveOptions(e,t),t}